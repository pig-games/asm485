opForge 8085 Assembler v1.0
ADDR    BYTES                    LINE  SOURCE
------  -----------------------  ----  ------
----                                1  ; Test program to bit-bang a single character out SOD as serial async data
----                                2  
----    EQU 0000                    3          .org     00000H
----                                4  
----    EQU 0113                    5  BITTIME .const     0113h          ; Time delay for a single bit
----    EQU 000B                    6  OUTBITS .const	00Bh
----                                7  
----                                8  START:
0000    0E                          9          mvi     c,'T'           ; Send a test character
    9 |         mvi     c,[31m'[0mT'           ; Send a test character
ERROR: ope006: string expression is not supported by portable expression VM
----                               10  COUT:
0001    F3                         11          di
0002    06 0B                      12          mvi     b,OUTBITS       ; Number of output bits
0004    AF                         13          xra     a               ; Clear carry for start bit
----                               14  CO1:
0005    3E 80                      15          mvi     a,080H          ; Set the SDE flag
0007    1F                         16          rar                     ; Shift carry into SOD flag
0008    3F                         17          cmc                     ;   and invert carry.  Why? (serial is inverted?)
0009    30                         18          sim                     ; Output data bit
000A    21 13 01                   19          lxi     h,BITTIME       ; Load the time delay for one bit width
----                               20  CO2:
000D    2D                         21          dcr     l               ; Wait for bit time
000E    C2 0D 00                   22          jnz     CO2
0011    25                         23          dcr     h
0012    C2 0D 00                   24          jnz     CO2
0015    37                         25          stc                     ; Shift in stop bit(s)
0016    79                         26          mov     a,c             ; Get char to send
0017    1F                         27          rar                     ; LSB into carry
0018    4F                         28          mov     c,a             ; Store rotated data
0019    05                         29          dcr     b
001A    C2 05 00                   30          jnz     CO1             ; Send next bit
001D    FB                         31          ei
----                               32  
001E    21 FF 3F                   33          lxi     h,03fffH        ; Wait a while before sending the character again
----                               34  CHILL:
0021    2D                         35          dcr     l
0022    C2 21 00                   36          jnz     CHILL
0025    25                         37          dcr     h
0026    C2 21 00                   38          jnz     CHILL
----                               39  
0029    C3 00 00                   40          jmp     START
----                               41  
----                               42  

Lines: 42  Errors: 1  Warnings: 0

SYMBOL TABLE

BITTIME         : 0113 (275)
OUTBITS         : 000b (11)
START           : 0000 (0)
COUT            : 0001 (1)
CO1             : 0005 (5)
CO2             : 000d (13)
CHILL           : 0021 (33)

Total memory is 44 bytes

GENERATED OUTPUT

ADDR    BYTES
------  -----------------------
0000    0E F3 06 0B AF 3E 80 1F 3F 30 21 13 01 2D C2 0D
0010    00 25 C2 0D 00 37 79 1F 4F 05 C2 05 00 FB 21 FF
0020    3F 2D C2 21 00 25 C2 21 00 C3 00 00
