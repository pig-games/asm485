opForge 8085 Assembler v1.0
ADDR    BYTES                    LINE  SOURCE
------  -----------------------  ----  ------
----                                1  ; 65816 runtime state assumptions (.assume)
----                                2  ; Demonstrates explicit E/M/X/DBR/DP assumptions and inferred PBR.
----                                3  
----                                4          .cpu 65816
----    EQU 123400                  5          .org $123400
----                                6  
----                                7  start:
----                                8          .assume e=native, m=16, x=16, dp=$2000
----                                9          .assume pbr=$12, dbr=$00 ; explicit mismatch
123400  4B                         10          phk
123401  EA                         11          nop                     ; stack-neutral: does not clear pending PHK bank source
123402  AB                         12          plb                     ; PHK/PLB infers DBR from explicit PBR
----                               13          .assume pbr=$00        ; override
----                               14          .assume pbr=auto       ; restore inferred PBR from current .org bank
----                               15  
123403  A9 34 12                   16          lda #$1234          ; A9 34 12 (A is 16-bit)
123406  A2 78 56                   17          ldx #$5678          ; A2 78 56 (X is 16-bit)
123409  AD 56 34                   18          lda $123456         ; AD 56 34 (DBR inferred from PHK/PLB + explicit PBR)
----                               19          .assume dbr=$12     ; known explicit DBR
12340C  48                         20          pha                 ; unknown stack source for PLB inference
12340D  AB                         21          plb                 ; DBR becomes unknown (no PHK/PHB pending source)
12340E  AF 56 34 12                22          lda $123456         ; AF 56 34 12 (unknown DBR prefers long-capable form)
123412  A5 F0                      23          lda $20F0           ; A5 F0 (DP assumption maps absolute address to direct-page offset)
123414  4C 10 32                   24          jmp $123210         ; 4C 10 32 (PBR defaults to current .org bank $12)
----                               25  
123417  E2 20                      26          sep #$20            ; A back to 8-bit
123419  A9 9A                      27          lda #$9A            ; A9 9A
----                               28  
----                               29          .assume e=emulation ; forces A/X to 8-bit
12341B  A2 BC                      30          ldx #$BC            ; A2 BC
----                               31  
12341D  60                         32          rts
----                               33  
----                               34          .end

Lines: 34  Errors: 0  Warnings: 0

SYMBOL TABLE

start           : 123400 (1192960)

Total memory is 30 bytes

GENERATED OUTPUT

ADDR    BYTES
------  -----------------------
123400    4B EA AB A9 34 12 A2 78 56 AD 56 34 48 AB AF 56
123410    34 12 A5 F0 4C 10 32 E2 20 A9 9A A2 BC 60
